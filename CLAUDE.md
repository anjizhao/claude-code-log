# Claude Code Log

A Python CLI tool that converts Claude Code transcript JSONL files into readable HTML format.

## Project Overview

This tool processes Claude Code transcript files (stored as JSONL) and generates clean, minimalist HTML pages with comprehensive session navigation and token usage tracking. It's designed to create a readable log of your Claude interactions with rich metadata and easy navigation.

## Key Features

- **Project Hierarchy Processing**: Process entire `~/.claude/projects/` directory with linked index page
- **Individual Session Files**: Generate separate HTML files for each session with navigation links
- **Session Navigation**: Interactive table of contents with session summaries and quick navigation
- **Token Usage Tracking**: Display token consumption for individual messages and session totals
- **Runtime Message Filtering**: JavaScript-powered filtering to show/hide message types
- **Interactive Timeline**: vis-timeline visualization with click-to-scroll navigation
- **Date Range Filtering**: Filter messages using natural language (e.g., "today", "yesterday")
- **Markdown Rendering**: Server-side markdown with syntax highlighting using mistune

## Usage

```bash
# Process all projects (default)
claude-code-log

# Single file/directory
claude-code-log path/to/transcript.jsonl

# With browser open
claude-code-log --open-browser

# Date filtering (natural language)
claude-code-log --from-date "yesterday" --to-date "today"
claude-code-log --from-date "last week"
```

**Output Files Generated:**
- `~/.claude/projects/index.html` - Master index with project cards
- `~/.claude/projects/project-name/combined_transcripts.html` - Combined project page
- `~/.claude/projects/project-name/session-{id}.html` - Individual session pages

## Development

See @CONTRIBUTING.md for detailed development setup, testing, architecture, and release process.

### Claude-Specific Testing Tips

**Always use `-n auto` for parallel test execution:**

```bash
# Unit tests (fast, recommended for development)
just test
# or: uv run pytest -n auto -m "not browser" -v

# Browser tests
just test-browser
# or: uv run pytest -n auto -m browser

# All tests
just test-all
```

**Tip:** Add `-x` to stop on first failure (e.g., `uv run pytest -n auto -m "not browser" -v -x`).

### Code Quality

```bash
ruff format           # Format code
ruff check --fix      # Lint and fix
uv run pyright        # Type check
uv run ty check       # Alternative type check
```

### Performance Profiling

```bash
CLAUDE_CODE_LOG_DEBUG_TIMING=1 claude-code-log path/to/file.jsonl
```

### Timeline Component

The interactive timeline is implemented in JavaScript within `claude_code_log/templates/components/timeline.html`. It parses message types from CSS classes generated by the Python renderer.

**Important**: When adding new message types or modifying CSS class generation in `renderer.py`, ensure the timeline's message type detection logic is updated accordingly to maintain feature parity. Also, make sure that the filter is still applied consistently to the messages both in the main transcript and in the timeline. You can use Playwright to test browser runtime features.

## Architecture

For detailed architecture documentation, see:
- [dev-docs/rendering-architecture.md](dev-docs/rendering-architecture.md) - Data flow and rendering pipeline
- [dev-docs/messages.md](dev-docs/messages.md) - Message type reference
- [dev-docs/css-classes.md](dev-docs/css-classes.md) - CSS class combinations
